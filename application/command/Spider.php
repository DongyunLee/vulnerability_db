<?php

namespace app\command;

use think\console\Command;
use think\console\Input;
use think\console\input\Argument;
use think\console\Output;

class Spider extends Command
{
    protected function configure()
    {
        // 指令配置
        $this->setName('spider')
            // 设置参数
            ->addArgument('max_id', Argument::REQUIRED, 'cnvd上的链接id')
            ->setDescription('automatic import xml');
    }
    
    protected function execute(Input $input, Output $output)
    {
        $id = $input->getArgument('max_id');
        $think_path = dirname(dirname(__DIR__));
        
        $date = date('Y-m-d H:i:s');
        $output->write("{$date} Process Starting…\n");
        for ($i = $id; $i > 0; $i--) {
            exec("php {$think_path}/think down {$i}");
        }
        $output->write("{$date} Process Finished\n");
    }
}
